<?php

namespace NFePHP\EFD\Blocks\ICMSIPI;

use NFePHP\EFD\Elements\ICMSIPI as Elements;
use NFePHP\EFD\Common\Block;
use NFePHP\EFD\Common\BlockInterface;

/**
 * Classe constutora do bloco E
 *
 * Esta classe irÃ¡ usar um recurso para invocar as classes de cada um dos elementos
 * constituintes listados
 */
final class BlockE extends Block implements BlockInterface
{
    const TOTAL = 'E990';
    public $regversion;
    public $fieldorder = [
     'E001' => [0 => [1 => 'REG',2=>'IND_MOV']],
     'E100' => [0 => [1 => 'REG',2=>'DT_INI',3=>'DT_FIN']],
     'E110' => [0 => [1 => 'REG',2=>'VL_TOT_DEBITOS',3=>'VL_AJ_DEBITOS',4=>'VL_TOT_AJ_DEBITOS',5=>'VL_ESTORNOS_CRED',6=>'VL_TOT_CREDITOS',7=>'VL_AJ_CREDITOS',8=>'VL_TOT_AJ_CREDITOS',9=>'VL_ESTORNOS_DEB',10=>'VL_SLD_CREDOR_ANT',11=>'VL_SLD_APURADO',12=>'VL_TOT_DED',13=>'VL_ICMS_RECOLHER',14=>'VL_SLD_CREDOR_TRANSPORTAR',15=>'DEB_ESP']],
     'E111' => [0 => [1 => 'REG',2=>'COD_AJ_APUR',3=>'DESCR_COMPL_AJ',4=>'VL_AJ_APUR']],
     'E112' => [0 => [1 => 'REG',2=>'NUM_DA',3=>'NUM_PROC',4=>'IND_PROC',5=>'PROC',6=>'TXT_COMPL']],
     'E113' => [0 => [1 => 'REG',2=>'COD_PART',3=>'COD_MOD',4=>'SER',5=>'SUB',6=>'NUM_DOC',7=>'DT_DOC',8=>'COD_ITEM',9=>'VL_AJ_ITEM',10=>'CHV_DOCe']],
     'E115' => [0 => [1 => 'REG',2=>'COD_INF_ADIC',3=>'VL_INF_ADIC',4=>'DESCR_COMPL_AJ']],
     'E116' => [0 => [1 => 'REG',2=>'COD_OR',3=>'VL_OR',4=>'DT_VCTO',5=>'COD_REC',6=>'NUM_PROC',7=>'IND_PROC',8=>'PROC',9=>'TXT_COMPL',10=>'MES_REF*']],
     'E200' => [0 => [1 => 'REG',2=>'UF',3=>'DT_INI',4=>'DT_FIN']],
     'E210' => [0 => [1 => 'REG',2=>'IND_MOV_ST',3=>'VL_SLD_CRED_ANT_ST',4=>'VL_DEVOL_ST',5=>'VL_RESSARC_ST',6=>'VL_OUT_CRED_ST',7=>'VL_AJ_CREDITOS_ST',8=>'VL_RETENCAO_ST',9=>'VL_OUT_DEB_ST',10=>'VL_AJ_DEBITOS_ST',11=>'VL_SLD_DEV_ANT_ST',12=>'VL_DEDUCOES_ST',13=>'VL_ICMS_RECOL_ST',14=>'VL_SLD_CRED_ST_TRANSPORTAR',15=>'DEB_ESP_ST']],
     'E220' => [0 => [1 => 'REG',2=>'COD_AJ_APUR',3=>'DESCR_COMPL_AJ',4=>'VL_AJ_APUR']],
     'E230' => [0 => [1 => 'REG',2=>'NUM_DA',3=>'NUM_PROC',4=>'IND_PROC',5=>'PROC',6=>'TXT_COMPL']],
     'E240' => [0 => [1 => 'REG',2=>'COD_PART',3=>'COD_MOD',4=>'SER',5=>'SUB',6=>'NUM_DOC',7=>'DT_DOC',8=>'COD_ITEM',9=>'VL_AJ_ITEM',10=>'CHV_DOCe']]
     'E250' => [0 => [1 => 'REG',2=>'COD_OR',3=>'VL_OR',4=>'DT_VCTO',5=>'COD_REC',6=>'NUM_PROC',7=>'IND_PROC',8=>'PROC',9=>'TXT_COMPL',10=>'MES_REF*']],
     'E300' => [0 => [1 => 'REG',2=>'UF',3=>'DT_INI',4=>'DT_FIN']],
     'E310' => [0 => [1 => 'REG',2=>'IND_MOV_FCP_DIFAL',3=>'VL_SLD_CRED_ANT_DIFAL',4=>'VL_TOT_DEBITOS_DIFAL',5=>'VL_OUT_DEB_DIFAL',6=>'VL_TOT_CREDITOS_DIFAL',7=>'VL_OUT_CRED_DIFAL',8=>'VL_SLD_DEV_ANT_DIFAL',9=>'VL_DEDUCOES_DIFAL',10=>'VL_RECOL_DIFAL',11=>'VL_SLD_CRED_TRANSPORTAR_DIFAL',12=>'DEB_ESP_DIFAL',13=>'VL_SLD_CRED_ANT_FCP',14=>'VL_TOT_DEB_FCP',15=>'VL_OUT_DEB_FCP',16=>'VL_TOT_CRED_FCP',17=>'VL_OUT_CRED_FCP',18=>'VL_SLD_DEV_ANT_FCP',19=>'VL_DEDUCOES_FCP',20=>'VL_RECOL_FCP',21=>'VL_SLD_CRED_TRANSPORTAR_FCP',22=>'DEB_ESP_FCP']]
     'E311' => [0 => [1 => 'REG',2=>'COD_AJ_APUR',3=>'DESCR_COMPL_AJ',4=>'VL_AJ_APUR']],
     'E312' => [0 => [1 => 'REG',2=>'NUM_DA',3=>'NUM_PROC',4=>'IND_PROC',5=>'PROC',6=>'TXT_COMPL']],
     'E313' => [0 => [1 => 'REG',2=>'COD_PART',3=>'COD_MOD',4=>'SER',5=>'SUB',6=>'NUM_DOC',7=>'CHV_DOCe',8=>'DT_DOC',9=>'COD_ITEM',10=>'VL_AJ_ITEM']],
     'E316' => [0 => [1 => 'REG',2=>'COD_OR',3=>'VL_OR',4=>'DT_VCTO',5=>'COD_REC',6=>'NUM_PROC',7=>'IND_PROC',8=>'PROC',9=>'TXT_COMPL',10=>'MES_REF*']],
     'E500' => [0 => [1 => 'REG',2=>'IND_APUR',3=>'DT_INI',4=>'DT_FIN']],
     'E510' => [0 => [1 => 'REG',2=>'CFOP',3=>'CST_IPI',4=>'VL_CONT_IPI',5=>'VL_BC_IPI',6=>'VL_IPI']],
     'E520' => [0 => [1 => 'REG',2=>'VL_SD_ANT_IPI',3=>'VL_DEB_IPI',4=>'VL_CRED_IPI',5=>'VL_OD_IPI',6=>'VL_OC_IPI',7=>'VL_SC_IPI',8=>'VL_SD_IPI']],
     'E530' => [0 => [1 => 'REG',2=>'IND_AJ',3=>'VL_AJ',4=>'COD_AJ',5=>'IND_DOC',6=>'NUM_DOC',7=>'DESCR_AJ']],
     'E531' => [0 => [1 => 'REG',2=>'COD_PART',3=>'COD_MOD',4=>'SER',5=>'SUB',6=>'NUM_DOC',7=>'DT_DOC',8=>'COD_ITEM',9=>'VL_AJ_ITEM',10=>'CHV_NFE']],
     'E990' => [0 => [1 => 'REG',2=>'QTD_LIN_E']]];

    public $elements = [
        'e001' => ['class' => Elements\E001::class, 'level' => 1, 'type' => 'single'],
        'e100' => ['class' => Elements\E100::class, 'level' => 2, 'type' => 'multiple'],
        'e110' => ['class' => Elements\E110::class, 'level' => 3, 'type' => 'single'],
        'e111' => ['class' => Elements\E111::class, 'level' => 4, 'type' => 'multiple'],
        'e112' => ['class' => Elements\E112::class, 'level' => 5, 'type' => 'multiple'],
        'e113' => ['class' => Elements\E113::class, 'level' => 5, 'type' => 'multiple'],
        'e115' => ['class' => Elements\E115::class, 'level' => 4, 'type' => 'multiple'],
        'e116' => ['class' => Elements\E116::class, 'level' => 4, 'type' => 'multiple'],
        'e200' => ['class' => Elements\E200::class, 'level' => 2, 'type' => 'multiple'],
        'e210' => ['class' => Elements\E200::class, 'level' => 3, 'type' => 'single'],
        'e220' => ['class' => Elements\E220::class, 'level' => 4, 'type' => 'multiple'],
        'e230' => ['class' => Elements\E230::class, 'level' => 5, 'type' => 'multiple'],
        'e240' => ['class' => Elements\E240::class, 'level' => 5, 'type' => 'multiple'],
        'e250' => ['class' => Elements\E250::class, 'level' => 4, 'type' => 'multiple'],
        'e300' => ['class' => Elements\E300::class, 'level' => 2, 'type' => 'multiple'],
        'e310' => ['class' => Elements\E310::class, 'level' => 3, 'type' => 'single'],
        'e311' => ['class' => Elements\E311::class, 'level' => 4, 'type' => 'multiple'],
        'e312' => ['class' => Elements\E312::class, 'level' => 5, 'type' => 'multiple'],
        'e313' => ['class' => Elements\E313::class, 'level' => 5, 'type' => 'multiple'],
        'e316' => ['class' => Elements\E316::class, 'level' => 4, 'type' => 'multiple'],
        'e500' => ['class' => Elements\E500::class, 'level' => 2, 'type' => 'multiple'],
        'e510' => ['class' => Elements\E510::class, 'level' => 3, 'type' => 'multiple'],
        'e520' => ['class' => Elements\E520::class, 'level' => 3, 'type' => 'single'],
        'e530' => ['class' => Elements\E530::class, 'level' => 4, 'type' => 'multiple'],
        'e531' => ['class' => Elements\E531::class, 'level' => 5, 'type' => 'multiple'],
    ];
    
    public function __construct($version='')
    {
        parent::__construct(self::TOTAL);
        if ($version!='') {
            switch ($version) {
               case '013': $this->regversion = ['E001'=>0,'E100'=>0,'E110'=>0,'E111'=>0,'E112'=>0,'E113'=>0,'E115'=>0,'E116'=>0,'E200'=>0,'E210'=>0,'E220'=>0,'E230'=>0,'E240'=>0,'E250'=>0,'E300'=>0,'E310'=>0,'E311'=>0,'E312'=>0,'E313'=>0,'E316'=>0,'E500'=>0,'E510'=>0,'E520'=>0,'E530'=>0,'E531'=>0,'E990'=>0]; 
                   break;
               default: $this->regversion = ['E001'=>0,'E100'=>0,'E110'=>0,'E111'=>0,'E112'=>0,'E113'=>0,'E115'=>0,'E116'=>0,'E200'=>0,'E210'=>0,'E220'=>0,'E230'=>0,'E240'=>0,'E250'=>0,'E300'=>0,'E310'=>0,'E311'=>0,'E312'=>0,'E313'=>0,'E316'=>0,'E500'=>0,'E510'=>0,'E520'=>0,'E530'=>0,'E531'=>0,'E990'=>0];
                   break;
           }
        }
    }
}
