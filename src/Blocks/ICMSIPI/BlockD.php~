<?php

namespace NFePHP\EFD\Blocks\ICMSIPI;

use NFePHP\EFD\Elements\ICMSIPI as Elements;
use NFePHP\EFD\Common\Block;
use NFePHP\EFD\Common\BlockInterface;

/**
 * Classe constutora do bloco D
 *
 * Esta classe irÃ¡ usar um recurso para invocar as classes de cada um dos elementos
 * constituintes listados
 */
final class BlockD extends Block implements BlockInterface
{
    const TOTAL = 'D990';
    public $regversion;
    public $fieldorder = [
      'D001' => [0 => [1 => 'REG',2=>'IND_MOV']]
      'D100' => [0 => [1 => 'REG',2=>'IND_OPER',3=>'IND_EMIT',4=>'COD_PART',5=>'COD_MOD',6=>'COD_SIT',7=>'SER',8=>'SUB',9=>'NUM_DOC',10=>'CHV_CTE',11=>'DT_DOC',12=>'DT_A_P',13=>'TP_CT-e',14=>'CHV_CTE_REF',15=>'VL_DOC',16=>'VL_DESC',17=>'IND_FRT',18=>'VL_SERV',19=>'VL_BC_ICMS',20=>'VL_ICMS',21=>'VL_NT',22=>'COD_INF',23=>'COD_CTA',24=>'COD_MUN_ORIG',25=>'COD_MUN_DEST']]
      'D101' => [0 => [1 => 'REG',2=>'VL_FCP_UF_DEST',3=>'VL_ICMS_UF_DEST',4=>'VL_ICMS_UF_REM']]
      'D110' => [0 => [1 => 'REG',2=>'NUM_ITEM',3=>'COD_ITEM',4=>'VL_SERV',5=>'VL_OUT']]
      'D120' => [0 => [1 => 'REG',2=>'COD_MUN_ORIG',3=>'COD_MUN_DEST',4=>'VEIC_ID',5=>'UF_ID']]
      'D130' => [0 => [1 => 'REG',2=>'COD_PART_CONSG',3=>'COD_PART_RED',4=>'IND_FRT_RED',5=>'COD_MUN_ORIG',6=>'COD_MUN_DEST',7=>'VEIC_ID',8=>'VL_LIQ_FRT',9=>'VL_SEC_CAT',10=>'VL_DESP',11=>'VL_PEDG',12=>'VL_OUT',13=>'VL_FRT',14=>'UF_ID']]
      'D140' => [0 => [1 => 'REG',2=>'COD_PART_CONSG',3=>'COD_MUN_ORIG',4=>'COD_MUN_DEST',5=>'IND_VEIC',6=>'VEIC_ID',7=>'IND_NAV',8=>'VIAGEM',9=>'VL_FRT_LIQ',10=>'VL_DESP_PORT',11=>'VL_DESP_CAR_DESC',12=>'VL_OUT',13=>'VL_FRT_BRT',14=>'VL_FRT_MM']]
      'D150' => [0 => [1 => 'REG',2=>'COD_MUN_ORIG',3=>'COD_MUN_DEST',4=>'VEIC_ID',5=>'VIAGEM',6=>'IND_TFA',7=>'VL_PESO_TX',8=>'VL_TX_TERR',9=>'VL_TX_RED',10=>'VL_OUT',11=>'VL_TX_ADV']]
      'D160' => [0 => [1 => 'REG',2=>'DESPACHO',3=>'CNPJ_CPF_REM',4=>'IE_REM',5=>'COD_MUN_ORI',6=>'CNPJ_CPF_DEST',7=>'IE_DEST',8=>'COD_MUN_DEST']]
      'D161' => [0 => [1 => 'REG',2=>'IND_CARGA',3=>'CNPJ_CPF_COL',4=>'IE_COL',5=>'COD_MUN_COL',6=>'CNPJ_CPF_ENTG',7=>'IE_ENTG',8=>'COD_MUN_ENTG']]
      'D162' => [0 => [1 => 'REG',2=>'COD_MOD',3=>'SER',4=>'NUM_DOC',5=>'DT_DOC',6=>'VL_DOC',7=>'VL_MERC',8=>'QTD_VOL',9=>'PESO_BRT',10=>'PESO_LIQ']]
      'D170' => [0 => [1 => 'REG',2=>'COD_PART_CONSG',3=>'COD_PART_RED',4=>'COD_MUN_ORIG',5=>'COD_MUN_DEST',6=>'OTM',7=>'IND_NAT_FRT',8=>'VL_LIQ_FRT',9=>'VL_GRIS',10=>'VL_PDG',11=>'VL_OUT',12=>'VL_FRT',13=>'VEIC_ID',14=>'UF_ID']]
      'D180' => [0 => [1 => 'REG',2=>'NUM_SEQ',3=>'IND_EMIT',4=>'CNPJ_CPF_EMIT',5=>'UF_EMIT',6=>'IE_EMIT',7=>'COD_MUN_ORIG',8=>'CNPJ_CPF_TOM',9=>'UF_TOM',10=>'IE_TOM',11=>'COD_MUN_DEST',12=>'COD_MOD',13=>'SER',14=>'SUB',15=>'NUM_DOC',16=>'DT_DOC',17=>'VL_DOC']]
      'D190' => [0 => [1 => 'REG',2=>'CST_ICMS',3=>'CFOP',4=>'ALIQ_ICMS',5=>'VL_OPR',6=>'VL_BC_ICMS',7=>'VL_ICMS',8=>'VL_RED_BC',9=>'COD_OBS']]
      'D195' => [0 => [1 => 'REG',2=>'COD_OBS',3=>'TXT_COMPL']]
      'D197' => [0 => [1 => 'REG',2=>'COD_AJ',3=>'DESCR_COMPL_AJ',4=>'COD_ITEM',5=>'VL_BC_ICMS',6=>'ALIQ_ICMS',7=>'VL_ICMS',8=>'VL_OUTROS']]
      'D300' => [0 => [1 => 'REG',2=>'COD_MOD',3=>'SER',4=>'SUB',5=>'NUM_DOC_INI',6=>'NUM_DOC_FIN',7=>'CST_ICMS',8=>'CFOP',9=>'ALIQ_ICMS',10=>'DT_DOC',11=>'VL_OPR',12=>'VL_DESC',13=>'VL_SERV',14=>'VL_SEG',15=>'VL_OUTDESP',16=>'VL_BC_ICMS',17=>'VL_ICMS',18=>'VL_RED_BC',19=>'COD_OBS',20=>'COD_CTA']]
      'D301' => [0 => [1 => 'REG',2=>'NUM_DOC_CANC']]
      'D310' => [0 => [1 => 'REG',2=>'COD_MUN_ORIG',3=>'VL_SERV',4=>'VL_BC_ICMS',5=>'VL_ICMS']]
      'D350' => [0 => [1 => 'REG',2=>'COD_MOD',3=>'ECF_MOD',4=>'ECF_FAB',5=>'ECF_CX']]
      'D355' => [0 => [1 => 'REG',2=>'DT_DOC',3=>'CRO',4=>'CRZ',5=>'NUM_COO_FIN',6=>'GT_FIN',7=>'VL_BRT']]
      'D360' => [0 => [1 => 'REG',2=>'VL_PIS',3=>'VL_COFINS']]
      'D365' => [0 => [1 => 'REG',2=>'COD_TOT_PAR',3=>'VLR_ACUM_TOT',4=>'NR_TOT',5=>'DESCR_NR_TOT']]
      'D370' => [0 => [1 => 'REG',2=>'COD_MUN_ORIG',3=>'VL_SERV',4=>'QTD_BILH',5=>'VL_BC_ICMS',6=>'VL_ICMS']]
      'D390' => [0 => [1 => 'REG',2=>'CST_ICMS',3=>'CFOP',4=>'ALIQ_ICMS',5=>'VL_OPR',6=>'VL_BC_ISSQN',7=>'ALIQ_ISSQN',8=>'VL_ISSQN',9=>'VL_BC_ICMS',10=>'VL_ICMS',11=>'COD_OBS']]
      'D400' => [0 => [1 => 'REG',2=>'COD_PART',3=>'COD_MOD',4=>'COD_SIT',5=>'SER',6=>'SUB',7=>'NUM_DOC',8=>'DT_DOC',9=>'VL_DOC',10=>'VL_DESC',11=>'VL_SERV',12=>'VL_BC_ICMS',13=>'VL_ICMS',14=>'VL_PIS',15=>'VL_COFINS',16=>'COD_CTA']]
      'D410' => [0 => [1 => 'REG',2=>'COD_MOD',3=>'SER',4=>'SUB',5=>'NUM_DOC_INI',6=>'NUM_DOC_FIN',7=>'DT_DOC',8=>'CST_ICMS',9=>'CFOP',10=>'ALIQ_ICMS',11=>'VL_OPR',12=>'VL_DESC',13=>'VL_SERV',14=>'VL_BC_ICMS',15=>'VL_ICMS']]
      'D411' => [0 => [1 => 'REG',2=>'NUM_DOC_CANC']]
      'D420' => [0 => [1 => 'REG',2=>'COD_MUN_ORIG',3=>'VL_SERV',4=>'VL_BC_ICMS',5=>'VL_ICMS']]
      'D500' => [0 => [1 => 'REG',2=>'IND_OPER',3=>'IND_EMIT',4=>'COD_PART',5=>'COD_MOD',6=>'COD_SIT',7=>'SER',8=>'SUB',9=>'NUM_DOC',10=>'DT_DOC',11=>'DT_A_P',12=>'VL_DOC',13=>'VL_DESC',14=>'VL_SERV',15=>'VL_SERV_NT',16=>'VL_TERC',17=>'VL_DA',18=>'VL_BC_ICMS',19=>'VL_ICMS',20=>'COD_INF',21=>'VL_PIS',22=>'VL_COFINS',23=>'COD_CTA',24=>'TP_ASSINANTE']]
      'D510' => [0 => [1 => 'REG',2=>'NUM_ITEM',3=>'COD_ITEM',4=>'COD_CLASS',5=>'QTD',6=>'UNID',7=>'VL_ITEM',8=>'VL_DESC',9=>'CST_ICMS',10=>'CFOP',11=>'VL_BC_ICMS',12=>'ALIQ_ICMS',13=>'VL_ICMS',14=>'VL_BC_ICMS_UF',15=>'VL_ICMS_UF',16=>'IND_REC',17=>'COD_PART',18=>'VL_PIS',19=>'VL_COFINS',20=>'COD_CTA']]
      'D530' => [0 => [1 => 'REG',2=>'IND_SERV',3=>'DT_INI_SERV',4=>'DT_FIN_SERV',5=>'PER_FISCAL',6=>'COD_AREA',7=>'TERMINAL']]
      'D590' => [0 => [1 => 'REG',2=>'CST_ICMS',3=>'CFOP',4=>'ALIQ_ICMS',5=>'VL_OPR',6=>'VL_BC_ICMS',7=>'VL_ICMS',8=>'VL_BC_ICMS_UF',9=>'VL_ICMS_UF',10=>'VL_RED_BC',11=>'COD_OBS']]
      'D600' => [0 => [1 => 'REG',2=>'COD_MOD',3=>'COD_MUN',4=>'SER',5=>'SUB',6=>'COD_CONS',7=>'QTD_CONS',8=>'DT_DOC',9=>'VL_DOC',10=>'VL_DESC',11=>'VL_SERV',12=>'VL_SERV_NT',13=>'VL_TERC',14=>'VL_DA',15=>'VL_BC_ICMS',16=>'VL_ICMS',17=>'VL_PIS',18=>'VL_COFINS']]
      'D610' => [0 => [1 => 'REG',2=>'COD_CLASS',3=>'COD_ITEM',4=>'QTD',5=>'UNID',6=>'VL_ITEM',7=>'VL_DESC',8=>'CST_ICMS',9=>'CFOP',10=>'ALIQ_ICMS',11=>'VL_BC_ICMS',12=>'VL_ICMS',13=>'VL_BC_ICMS_UF',14=>'VL_ICMS_UF',15=>'VL_RED_BC',16=>'VL_PIS',17=>'VL_COFINS',18=>'COD_CTA']]
      'D690' => [0 => [1 => 'REG',2=>'CST_ICMS',3=>'CFOP',4=>'ALIQ_ICMS',5=>'VL_OPR',6=>'VL_BC_ICMS',7=>'VL_ICMS',8=>'VL_BC_ICMS_UF',9=>'VL_ICMS_UF',10=>'VL_RED_BC',11=>'COD_OBS']]
      'D695' => [0 => [1 => 'REG',2=>'COD_MOD',3=>'SER',4=>'NRO_ORD_INI',5=>'NRO_ORD_FIN',6=>'DT_DOC_INI',7=>'DT_DOC_FIN',8=>'NOM_MEST',9=>'CHV_COD_DIG']]
      'D696' => [0 => [1 => 'REG',2=>'CST_ICMS',3=>'CFOP',4=>'ALIQ_ICMS',5=>'VL_OPR',6=>'VL_BC_ICMS',7=>'VL_ICMS',8=>'VL_BC_ICMS_UF',9=>'VL_ICMS_UF',10=>'VL_RED_BC',11=>'COD_OBS']]
      'D697' => [0 => [1 => 'REG',2=>'UF',3=>'VL_BC_ICMS',4=>'VL_ICMS']]
      'D990' => [0 => [1 => 'REG',2=>'QTD_LIN_D']]
      ];


    public $elements = [
        'd001' => ['class' => Elements\D001::class, 'level' => 1, 'type' => 'single'],
        'd100' => ['class' => Elements\D100::class, 'level' => 2, 'type' => 'multiple'],
        'd101' => ['class' => Elements\D101::class, 'level' => 3, 'type' => 'single'],
        'd110' => ['class' => Elements\D110::class, 'level' => 3, 'type' => 'multiple'],
        'd120' => ['class' => Elements\D120::class, 'level' => 4, 'type' => 'multiple'],
        'd130' => ['class' => Elements\D130::class, 'level' => 3, 'type' => 'multiple'],
        'd140' => ['class' => Elements\D140::class, 'level' => 3, 'type' => 'single'],
        'd150' => ['class' => Elements\D150::class, 'level' => 3, 'type' => 'single'],
        'd160' => ['class' => Elements\D160::class, 'level' => 3, 'type' => 'multiple'],
        'd161' => ['class' => Elements\D161::class, 'level' => 4, 'type' => 'single'],
        'd162' => ['class' => Elements\D162::class, 'level' => 4, 'type' => 'multiple'],
        'd170' => ['class' => Elements\D170::class, 'level' => 3, 'type' => 'single'],
        'd180' => ['class' => Elements\D180::class, 'level' => 3, 'type' => 'multiple'],
        'd190' => ['class' => Elements\D190::class, 'level' => 3, 'type' => 'multiple'],
        'd195' => ['class' => Elements\D195::class, 'level' => 3, 'type' => 'multiple'],
        'd197' => ['class' => Elements\D197::class, 'level' => 4, 'type' => 'multiple'],
        'd300' => ['class' => Elements\D300::class, 'level' => 2, 'type' => 'multiple'],
        'd301' => ['class' => Elements\D301::class, 'level' => 3, 'type' => 'multiple'],
        'd310' => ['class' => Elements\D310::class, 'level' => 3, 'type' => 'multiple'],
        'd350' => ['class' => Elements\D350::class, 'level' => 2, 'type' => 'multiple'],
        'd355' => ['class' => Elements\D355::class, 'level' => 3, 'type' => 'multiple'],
        'd360' => ['class' => Elements\D360::class, 'level' => 4, 'type' => 'single'],
        'd365' => ['class' => Elements\D365::class, 'level' => 4, 'type' => 'multiple'],
        'd370' => ['class' => Elements\D370::class, 'level' => 5, 'type' => 'multiple'],
        'd390' => ['class' => Elements\D390::class, 'level' => 4, 'type' => 'multiple'],
        'd400' => ['class' => Elements\D400::class, 'level' => 2, 'type' => 'multiple'],
        'd410' => ['class' => Elements\D410::class, 'level' => 3, 'type' => 'multiple'],
        'd411' => ['class' => Elements\D411::class, 'level' => 4, 'type' => 'multiple'],
        'd420' => ['class' => Elements\D420::class, 'level' => 3, 'type' => 'multiple'],
        'd500' => ['class' => Elements\D500::class, 'level' => 2, 'type' => 'multiple'],
        'd510' => ['class' => Elements\D510::class, 'level' => 3, 'type' => 'multiple'],
        'd530' => ['class' => Elements\D530::class, 'level' => 3, 'type' => 'multiple'],
        'd590' => ['class' => Elements\D590::class, 'level' => 3, 'type' => 'multiple'],
        'd600' => ['class' => Elements\D600::class, 'level' => 2, 'type' => 'multiple'],
        'd610' => ['class' => Elements\D610::class, 'level' => 3, 'type' => 'multiple'],
        'd690' => ['class' => Elements\D690::class, 'level' => 3, 'type' => 'multiple'],
        'd695' => ['class' => Elements\D695::class, 'level' => 2, 'type' => 'multiple'],
        'd696' => ['class' => Elements\D696::class, 'level' => 3, 'type' => 'multiple'],
        'd697' => ['class' => Elements\D697::class, 'level' => 4, 'type' => 'multiple']
    ];
    
    public function __construct($version='')
    {
        parent::__construct(self::TOTAL);
        if ($version!='') {
            switch ($version) {
               case '013': $this->regversion = ['D001'=>0,'D100'=>0,'D101'=>0,'D110'=>0,'D120'=>0,'D130'=>0,'D140'=>0,'D150'=>0,'D160'=>0,'D161'=>0,'D162'=>0,'D170'=>0,'D180'=>0,'D190'=>0,'D195'=>0,'D197'=>0,'D300'=>0,'D301'=>0,'D310'=>0,'D350'=>0,'D355'=>0,'D360'=>0,'D365'=>0,'D370'=>0,'D390'=>0,'D400'=>0,'D410'=>0,'D411'=>0,'D420'=>0,'D500'=>0,'D510'=>0,'D530'=>0,'D590'=>0,'D600'=>0,'D610'=>0,'D690'=>0,'D695'=>0,'D696'=>0,'D697'=>0,'D990'=>0];
                   break;
               default: $this->regversion = ['D001'=>0,'D100'=>0,'D101'=>0,'D110'=>0,'D120'=>0,'D130'=>0,'D140'=>0,'D150'=>0,'D160'=>0,'D161'=>0,'D162'=>0,'D170'=>0,'D180'=>0,'D190'=>0,'D195'=>0,'D197'=>0,'D300'=>0,'D301'=>0,'D310'=>0,'D350'=>0,'D355'=>0,'D360'=>0,'D365'=>0,'D370'=>0,'D390'=>0,'D400'=>0,'D410'=>0,'D411'=>0,'D420'=>0,'D500'=>0,'D510'=>0,'D530'=>0,'D590'=>0,'D600'=>0,'D610'=>0,'D690'=>0,'D695'=>0,'D696'=>0,'D697'=>0,'D990'=>0];
                   break;
           }
        }
    }
}
